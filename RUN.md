#  Инструкция по запуску NoiseLab++

## Локальный запуск

### 1. Предварительные требования

- Python 3.11 или выше
- pip (менеджер пакетов Python)
- Виртуальное окружение (рекомендуется)

### 2. Установка зависимостей

```bash
# Создайте виртуальное окружение (если еще не создано)
python -m venv venv

# Активируйте виртуальное окружение
# На macOS/Linux:
source venv/bin/activate
# На Windows:
venv\Scripts\activate

# Установите все зависимости
pip install -r requirements.txt
```

### 3. Запуск веб-интерфейса

#### Вариант 1: Streamlit (Рекомендуется)

Streamlit предоставляет полноценный интерактивный интерфейс с визуализацией.

```bash
# Из корневой директории проекта
streamlit run web/streamlit_app.py
```

После запуска:
- Автоматически откроется браузер на `http://localhost:8501`
- Если не открылся автоматически, перейдите по ссылке вручную
- Интерфейс готов к использованию!

**Дополнительные параметры запуска:**

```bash
# Запуск на другом порту
streamlit run web/streamlit_app.py --server.port 8080

# Запуск с отключением автоматического открытия браузера
streamlit run web/streamlit_app.py --server.headless true

# Запуск с темной темой
streamlit run web/streamlit_app.py --theme.base dark
```

#### Вариант 2: Flask API (Backend)

Если нужен только API сервер для интеграции с другим фронтендом:

```bash
# Из корневой директории проекта
python web/app.py
```

API будет доступен на `http://localhost:5000`

**Доступные endpoints:**
- `GET /api/health` - проверка работоспособности
- `GET /api/channels/list` - список доступных каналов
- `POST /api/tomography/run` - запуск томографии
- `POST /api/tomography/multiple` - множественные прогоны

### 4. Использование интерфейса

После запуска Streamlit приложения:

1. **Панель управления (слева):**
   - Выберите число кубитов (1 или 2)
   - Выберите тип квантового канала
   - Настройте параметры канала (с помощью слайдеров)
   - Задайте число измерений (shots)
   - Включите/выключите шум измерений
   - Выберите метод реконструкции (LSQ или MLE)

2. **Запуск эксперимента:**
   - Нажмите кнопку " Запустить томографию"
   - Дождитесь завершения вычислений

3. **Результаты:**
   - **Визуализация каналов:** матрица Чой, операторы Крауса, PTM, сфера Блоха (для 1 кубита)
   - **Графики и аналитика:** сравнение параметров, метрики качества
   - **Протокол:** детали выполнения томографии

4. **Статистический анализ:**
   - Включите опцию "Множественные прогоны"
   - Задайте число прогонов (5-50)
   - Получите статистику по распределению fidelity

### 5. Остановка приложения

- **Streamlit:** нажмите `Ctrl+C` в терминале
- **Flask:** нажмите `Ctrl+C` в терминале

## Тестирование

Перед запуском рекомендуется выполнить тесты:

```bash
# Запуск всех тестов
pytest tests/

# Запуск конкретного теста
pytest tests/test_tomography.py -v

# Запуск с покрытием кода
pytest tests/ --cov=noiselab --cov-report=html
```

## Решение проблем

### Проблема: ModuleNotFoundError

```bash
# Убедитесь, что виртуальное окружение активировано
# Переустановите зависимости
pip install -r requirements.txt --force-reinstall
```

### Проблема: Streamlit не запускается

```bash
# Проверьте версию Streamlit
streamlit --version

# Переустановите Streamlit
pip install streamlit --upgrade
```

### Проблема: Ошибки импорта noiselab

```bash
# Убедитесь, что вы запускаете из корневой директории проекта
# Проверьте PYTHONPATH
export PYTHONPATH="${PYTHONPATH}:$(pwd)"
```

### Проблема: Медленная работа

- Уменьшите число shots (например, до 500)
- Уменьшите число прогонов при статистическом анализе
- Используйте метод LSQ вместо MLE (быстрее, но менее точный)

## Логи и отладка

Streamlit автоматически показывает логи в консоли. Для более детальной отладки:

```python
# Добавьте в код
import streamlit as st
st.write("Debug info:", variable)
```

## Производительность

**Рекомендуемые параметры для разных сценариев:**

| Сценарий | Кубиты | Shots | Метод | Время |
|----------|--------|-------|-------|-------|
| Быстрое тестирование | 1 | 500 | LSQ | ~5 сек |
| Стандартное использование | 1 | 1000 | LSQ | ~10 сек |
| Высокая точность | 1 | 5000 | MLE | ~30 сек |
| 2-кубитная система | 2 | 1000 | LSQ | ~30 сек |
| 2-кубита + высокая точность | 2 | 5000 | MLE | ~2 мин |

## Дополнительные возможности

### Кастомизация интерфейса

Создайте файл `.streamlit/config.toml` в корне проекта:

```toml
[theme]
primaryColor = "#1f77b4"
backgroundColor = "#ffffff"
secondaryBackgroundColor = "#f0f2f6"
textColor = "#262730"
font = "sans serif"

[server]
port = 8501
enableCORS = false
enableXsrfProtection = true
maxUploadSize = 200

[browser]
gatherUsageStats = false
```

### Экспорт результатов

В будущих версиях будет добавлен функционал экспорта:
- Сохранение матриц в CSV/JSON
- Экспорт графиков в PNG/SVG
- Генерация отчетов в PDF

## Полезные ссылки

- [Streamlit документация](https://docs.streamlit.io/)
- [Qiskit документация](https://qiskit.org/documentation/)
- [Документация проекта](README.md)
